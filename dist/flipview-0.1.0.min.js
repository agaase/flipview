/*! flipview.js - v0.1.0 - 2014-12-14
* https://github.com/agaase/
* Copyright (c) 2014 agaase; Licensed MIT */
var flipview=function(){var a={fast:700,slow:2e3,"default":1300},b=.3,c=function(a,b,c){this.params=c||{},this.flipArea=a.parent(),this.w=this.flipArea.width(),this.leftCutoff=a[0].getBoundingClientRect().left+parseInt(this.w/2-this.w/15,10),this.rightCutoff=a[0].getBoundingClientRect().left+parseInt(this.w/2+this.w/15,10),this.flipEle=a,this.rotAngle=0,this.maxSlides=b,this.slideIds=[-1,0,1],f.call(this),g.call(this),e.call(this)},d=function(a,b,c){a=a||(-1===c?b+180:b-180),console.log("Rotating from angle - "+a+" to angle - "+b);var d=Math.abs(Math.abs(a)-Math.abs(b)),e=parseInt((d-90)/180*100,10),f=this.params.speed*e/100;if(d>90){var g=-1===c?b+90:b-90;this.flipEle.css({"-webkit-transform":"scale("+this.params.maxScale+") rotateY("+g+"deg)",transform:"scale("+this.params.maxScale+") rotateY("+g+"deg)","-webkit-transition-duration":f+"s","-webkit-transition-timing-function":"linear","transition-duration":f+"s","transition-timing-function":"linear"}),setTimeout(function(){this.flipEle.css({"-webkit-transform":"scale(1) rotateY("+b+"deg)",transform:"scale(1) rotateY("+b+"deg)","-webkit-transition-duration":this.params.speed-f+"s","-webkit-transition-timing-function":"linear","transition-duration":this.params.speed-f+"s","transition-timing-function":"linear"})}.bind(this),1e3*f)}else{var h=this.params.speed/180*Math.abs(a-b)*1e3;setTimeout(function(){this.flipEle.css({"-webkit-transform":"rotateY("+b+"deg)",transform:"rotateY("+b+"deg)","-webkit-transition-duration":this.params.speed+"s","-webkit-transition-timing-function":"linear","transition-duration":this.params.speed+"s","transition-timing-function":"linear"})}.bind(this),h)}},e=function(){var c=parseInt(this.params.speed,10),d=window.innerWidth>700?a[this.params.speed]:500;c||(c=("string"==typeof this.params.speed?a[this.params.speed]:d)||d),c||(c="string"==typeof this.params.speed?c:"default",c=a[c]||a["default"],c=window.innerWidth<700?c/1.5:c),this.params.speed=c/1e3,this.params.maxScale="number"==typeof this.params.maxScale?this.params.maxScale:b},f=function(){this.flipEle.css("position","relative").append("<div class='front'></div>").append("<div class='next'></div>").append("<div class='prev'></div>"),this.flipArea.css({"-webkit-perspective":"1000",perspective:"1000"}),this.flipEle.css({"-webkit-transform-style":"preserve-3d","transform-style":"preserve-3d"}),$("> div",this.flipEle).css({"-webkit-backface-visibility":"hidden","backface-visibility":"hidden",position:"absolute",height:"100%",width:"100%"}).addClass("flipSlide"),$(".next,.prev",this.flipEle).hide().css({"-webkit-transform":"rotateY(-180deg)",transform:"rotateY(-180deg)"})},g=function(){var a,b,c,d,e=10,f=!0,g=!1,h=function(a){this.flipLock||(g=!0);var b="mousedown"===a.originalEvent.type?a.originalEvent:a.originalEvent.changedTouches[0];c=b.pageX,d=b.pageX}.bind(this),j=function(a){a.preventDefault(),b&&clearTimeout(b),b=setTimeout(function(){var b="mousemove"===a.originalEvent.type?a.originalEvent:a.originalEvent.changedTouches[0];g&&(Math.abs(b.pageX-d)<e,d=b.pageX,(c<this.leftCutoff&&-1!==this.slideIds[0]||c>this.rightCutoff&&-1!==this.slideIds[2])&&(f&&(c<this.leftCutoff?($(".prev",this.flipEle).show(),$(".next",this.flipEle).hide()):c>this.rightCutoff&&($(".next",this.flipEle).show(),$(".prev",this.flipEle).hide()),k.call(this,(b.pageX-c)/2,c<this.leftCutoff?1:-1),f=!1),k.call(this,(b.pageX-c)/3,c<this.leftCutoff?1:-1)))}.bind(this),f?10:5)}.bind(this),l=function(d){g&&(d.preventDefault(),a&&clearTimeout(a),b&&clearTimeout(b),a=setTimeout(function(){g=!1;var a="mouseup"===d.originalEvent.type?d.originalEvent:d.originalEvent.changedTouches[0];a.pageX-c<-100&&c>this.rightCutoff&&-1!==this.slideIds[2]?(f&&($(".next",this.flipEle).show(),$(".prev",this.flipEle).hide()),setTimeout(function(){i.call(this,-1),f=!0}.bind(this),50),f=!0):a.pageX-c>100&&c<this.leftCutoff&&-1!==this.slideIds[0]?(f&&($(".prev",this.flipEle).show(),$(".next",this.flipEle).hide()),setTimeout(function(){i.call(this,1),f=!0}.bind(this),50)):(k.call(this,0,1),this.flipEle.css({"transition-duration":this.params.speed+"s"}),f=!0)}.bind(this),50))}.bind(this);this.flipArea.on("touchstart",h).on("touchmove",j).on("touchend",l),this.flipArea.on("mousedown",h).on("mousemove",j).on("mouseup",l)},h=function(a){var b=$(".next",this.flipEle),c=$(".front",this.flipEle),d=$(".prev",this.flipEle);0>a?(this.slideIds[0]=this.slideIds[1],this.slideIds[1]=this.slideIds[2],this.slideIds[2]=this.slideIds[1]+1<this.maxSlides?this.slideIds[1]+1:-1,b.removeClass("next").addClass("front"),d.removeClass("prev").addClass("next"),c.removeClass("front").addClass("prev")):(this.slideIds[2]=this.slideIds[1],this.slideIds[1]=this.slideIds[0],this.slideIds[0]=this.slideIds[0]-1,b.removeClass("next").addClass("prev"),d.removeClass("prev").addClass("front"),c.removeClass("front").addClass("next"))},i=function(a){this.flipLock=!0,setTimeout(function(){this.flipLock=!1}.bind(this),1e3*this.params.speed),this.beforeFlip&&this.beforeFlip(a);this.rotAngle;this.rotAngle+=180*a;this.rotAngle;d.call(this,this.panAngle,this.rotAngle,a),this.panAngle=void 0,setTimeout(function(){h.call(this,a),0>a?(this.onFlipNext(),$(".next",this.flipEle).css({"-webkit-transform":"rotateY("+this.slideIds[2]%2*180+"deg)",transform:"rotateY("+this.slideIds[2]%2*180+"deg)"})):a>0&&(this.onFlipPrev(),$(".prev",this.flipEle).css({"-webkit-transform":"rotateY("+this.slideIds[2]%2*180+"deg)",transform:"rotateY("+this.slideIds[2]%2*180+"deg)"}))}.bind(this),1e3*this.params.speed)},j=function(a){a=Math.min(Math.abs(a),180),a=a>90?90-a:a;var b=1-this.params.maxScale;return 1-(a>=0?a/90*b:b+a/90*b)},k=function(a,b){if(!this.flipLock){a=800*a/window.innerWidth;var c=this.rotAngle+a;b>0?(this.panAngle=c,c=c<this.rotAngle?this.rotAngle:c,c-this.rotAngle>=180&&(c=this.rotAngle+180)):0>=b&&(this.panAngle=c,c=c>this.rotAngle?this.rotAngle:c,this.rotAngle-c>=180&&(c=this.rotAngle-180)),this.panAngle=c;var d=this.params.speed/180*Math.abs(c-this.rotAngle),e=j.call(this,a);this.flipEle.css({"-webkit-transform":"scale("+e+") rotateY("+c+"deg)",transform:"scale("+e+") rotateY("+c+"deg)","-webkit-transition-duration":""+d+"s","-webkit-transition-timing-function":"linear","transition-duration":""+d+"s","transition-timing-function":"linear"})}};return c}();